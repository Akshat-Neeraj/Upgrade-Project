<!DOCTYPE html>
<html>
<head>
    <title>Game Vault</title>
    <link rel="icon" href="GV.png">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/056449f757.js" crossorigin="anonymous"></script>

    <style>
      body {
        background-color: #1a1a1d;
        color: #f8f9fa;
        padding-bottom: 80px; 
      }

      .navbar-custom {
          background-color: #212529;
          margin-bottom: 2rem;
      }
      .navbar-custom .navbar-brand img { height: 40px; width: auto; vertical-align: middle; }
      .navbar-custom .nav-link { color: rgba(255, 255, 255, 0.7); }
      .navbar-custom .nav-link:hover,
      .navbar-custom .nav-link.active { color: #fff; }
      .btn-search { color: rgba(255, 255, 255, 0.7); background: transparent; border: none; padding: 0.375rem 0.75rem; }
      .btn-search:hover { color: white; }

      .sorted-games-container {
          text-align: center;
          margin-bottom: 2.5rem;
          color: #c5c6c7; 
      }
      .sorted-games-container h2 {
          font-size: 1.8rem; 
          margin-bottom: 1rem;
          color: #66fcf1; 
      }
      .form-select-dark {
          background-color: #2c2f33;
          color: #f8f9fa;
          border: 1px solid #444;
      }
      .form-select-dark:focus {
          border-color: #66fcf1;
          box-shadow: 0 0 0 0.25rem rgba(102, 252, 241, 0.25);     background-color: #2c2f33;
          color: #f8f9fa;
      }

      .game-block {
          background-color: #2c2f33;
          border: 1px solid #444;
          border-radius: 0.5rem;
          padding: 1.25rem; 
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
          display: flex;
          flex-direction: column;
          align-items: center;
          text-align: center;
          height: 100%; 
          transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
          position: relative;
        }

        .game-block:hover {
          transform: translateY(-4px);
          box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
      }

      .game-block img {
          width: 100%;
          max-width: 200px;
          height: 150px;
          object-fit: cover;
          border-radius: 0.375rem; 
          margin-bottom: 1rem;
      }

      .game-block h3 {
          margin-bottom: 0.75rem;
          font-size: 1.2rem;
          color: #e0e0e0;
      }

      .rating-number {
          margin-bottom: 1rem;
          font-size: 1.1rem;
          font-weight: bold;
          color: #0dcaf0; 
      }

      .review-section {
          width: 100%;
          margin-top: 1.5rem;
          border-top: 1px solid #444; 
          padding-top: 1.5rem;
      }

      .review-section h4 { 
          text-align: center;
          margin-bottom: 1rem;
          font-size: 1rem;
          color: #c5c6c7;
          text-transform: uppercase;
          letter-spacing: 0.5px;
      }

      .review-section .form-control { 
          background-color: #3a3f44; 
          color: #f8f9fa;
          border: 1px solid #555;
          margin-bottom: 0.75rem;
      }
      .review-section .form-control::placeholder {
          color: #888;
      }
      .review-section .form-control:focus {
          background-color: #3a3f44;
          color: #f8f9fa;
          border-color: #66fcf1;
          box-shadow: 0 0 0 0.2rem rgba(102, 252, 241, 0.2);
      }
      
      .review-section .btn-success {
          
          width: 100%;
      }

      
      .user-reviews {
          margin-top: 1rem;
          max-height: 200px; 
          overflow-y: auto;
          padding-right: 10px; 
      }
       .user-reviews::-webkit-scrollbar { width: 6px; }
       .user-reviews::-webkit-scrollbar-track { background: #3a3f44; border-radius: 3px; }
       .user-reviews::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
       .user-reviews::-webkit-scrollbar-thumb:hover { background: #666; }

      .user-reviews .review {
          background-color: #3a3f44; 
          padding: 0.75rem;
          margin-bottom: 0.75rem;
          border-radius: 0.375rem;
          border-left: 3px solid #0dcaf0; 
          text-align: left;
      }

      .user-reviews .review .rating {
          font-size: 1rem;
          color: gold; 
          margin-bottom: 0.25rem;
      }

      .user-reviews .review p { 
          font-size: 0.9rem;
          color: #e0e0e0; 
          margin-bottom: 0;
          font-style: italic;
      }
      .user-reviews .review p .review-user {
          font-style: normal;
          font-weight: bold;
          color: #adb5bd;
      }

      footer {
        color: #adb5bd;
        background-color: #212529;
      }
    </style>

</head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-custom">
            <div class="container-fluid">
                <a class="navbar-brand" href="about.html"><img src="GV.png" alt="Game Vault Logo"></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon navbar-dark"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link" href="index.html">Library</a></li>
                        <li class="nav-item"><a class="nav-link" href="Store.html">Store</a></li>
                        <li class="nav-item"><a class="nav-link" href="About.html">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="review.html">Review</a></li>
                    </ul>
                     <button class="btn btn-search" data-bs-toggle="modal" data-bs-target="#searchModal"><i class="fa-solid fa-magnifying-glass fs-5"></i></button>
                </div>
            </div>
        </nav>

        <div class="container">

            <div class="sorted-games-container">
                <h2>Sort Games by Rating</h2>
                <select id="ratingSort" class="form-select form-select-dark w-50 mx-auto" onchange="sortGames()">
                    <option value="highestToLowest">Highest Rating First</option>
                    <option value="lowestToHighest">Lowest Rating First</option>
                </select>
            </div>

            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-2 g-4" id="gameContainer">
            </div>

        </div> 

        <footer class="text-center py-3 fixed-bottom">
            © 2024 Game Vault. All Rights Reserved
        </footer>

        <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header border-secondary">
                <h5 class="modal-title" id="searchModalLabel">Search Reviews</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <input type="search" class="form-control form-control-dark" placeholder="Search games or reviews...">
              </div>
              <div class="modal-footer border-secondary">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Search</button>
              </div>
            </div>
          </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const games = [
                {id: 1, title: "GTA 5", image: "Gta.png", rating: 5, reviews: [{ user: "John", rating: 5, feedback: "Great game, loved it!" }]},
                {id: 2, title: "Forza Horizon 5", image: "FH5.png", rating: 5, reviews: [{ user: "Mark", rating: 5, feedback: "Absolutely fantastic!" }]},
                {id: 3, title: "Assassin's Creed Mirage", image: "a.jpg", rating: 5, reviews: [{ user: "Alex", rating: 5, feedback: "Best AC game ever!" }]}, 
                {id: 4, title: "Naruto Game", image: "itachi.jpg", rating: 5, reviews: [{ user: "Chris", rating: 5, feedback: "Good story, great graphics!" }]},
                {id: 5, title: "Watch Dogs Legion", image: "w d.jpg", rating: 5, reviews: [{ user: "Emily", rating: 5, feedback: "Love the multiplayer!" }]},
                {id: 6, title: "Watch Dogs 2", image: "w d 2.jpg", rating: 5, reviews: [{ user: "Liam", rating: 5, feedback: "One of the best." }]},
                {id: 7, title: "SpiderMan 2", image: "s 2.jpg", rating: 4.5, reviews: [{ user: "Sophia", rating: 4, feedback: "Amazing web-slinging!" }]}, 
                {id: 8, title: "Valorant", image: "val.jpg", rating: 4.2, reviews: [{ user: "Noah", rating: 4, feedback: "Tactical and fun." }]},
                {id: 9, title: "Wuthering Waves", image: "ww.jpg", rating: 3.8, reviews: [{ user: "Olivia", rating: 3, feedback: "Interesting world, needs polish." }]},
                {id: 10, title: "Days Gone", image: "d.jpg", rating: 3.5, reviews: [{ user: "Ethan", rating: 4, feedback: "Underrated gem!" }]},
                {id: 11, title: "Dark Souls", image: "d s.jpg", rating: 4.8, reviews: [{ user: "Ava", rating: 5, feedback: "Prepare to die... and love it." }]},
                {id: 12, title: "Hitman 2", image: "h2.jpg", rating: 4.0, reviews: [{ user: "Mason", rating: 4, feedback: "Great stealth sandbox." }]},
                {id: 13, title: "Horizon Zero Dawn", image: "h.jpg", rating: 4.7, reviews: [{ user: "Isabella", rating: 5, feedback: "Beautiful world, engaging story." }]},
                {id: 14, title: "Japan Scenery", image: "3.gif", rating: 3.0, reviews: [{ user: "Mia", rating: 3, feedback: "Nice visuals, not really a game?" }]}
            ];

            function displayGames(sortedGames) {
                const gameContainer = document.getElementById("gameContainer");
                gameContainer.innerHTML = '';

                sortedGames.forEach(game => {
                    const colDiv = document.createElement('div');
                    
                    colDiv.className = 'col';

                    const gameElement = createGameElement(game);
                    colDiv.appendChild(gameElement); 

                    gameContainer.appendChild(colDiv);
                    
                });
            }

            function createGameElement(game) {
                const gameBlock = document.createElement('div');
                gameBlock.classList.add('game-block'); 

                const gameImg = document.createElement('img');
                gameImg.src = game.image;
                gameImg.alt = game.title;
                gameBlock.appendChild(gameImg);

                const gameTitle = document.createElement('h3');
                gameTitle.textContent = game.title;
                gameBlock.appendChild(gameTitle);

                const ratingNumber = document.createElement('div');
                ratingNumber.classList.add('rating-number');
                ratingNumber.textContent = `Avg Rating: ${game.rating.toFixed(1)}`; 
                gameBlock.appendChild(ratingNumber);

                const reviewSection = document.createElement('div');
                reviewSection.classList.add('review-section');

                const reviewDisplayTitle = document.createElement('h4');
                reviewDisplayTitle.textContent = "User Reviews";
                reviewSection.appendChild(reviewDisplayTitle);

                const userReviews = document.createElement('div');
                userReviews.classList.add('user-reviews');
                if (game.reviews && game.reviews.length > 0) {
                    game.reviews.forEach(review => {
                        const reviewDiv = document.createElement('div');
                        reviewDiv.classList.add('review');
                        const ratingDiv = document.createElement('div');
                        ratingDiv.classList.add('rating'); 
                        
                         for (let i = 1; i <= 5; i++) {
                            ratingDiv.textContent += (i <= review.rating) ? "★" : "☆";
                        }
                        reviewDiv.appendChild(ratingDiv);

                        const feedbackP = document.createElement('p');
                        const userSpan = document.createElement('span'); 
                        userSpan.className = 'review-user';
                        userSpan.textContent = `${review.user || 'Anonymous'}: `;
                        feedbackP.appendChild(userSpan);
                        feedbackP.appendChild(document.createTextNode(`"${review.feedback}"`)); 
                        reviewDiv.appendChild(feedbackP);

                        userReviews.appendChild(reviewDiv);
                    });
                } else {
                    const noReviewsP = document.createElement('p');
                    noReviewsP.textContent = "No reviews yet. Be the first!";
                    noReviewsP.style.fontStyle = 'italic';
                    noReviewsP.style.color = '#888';
                    userReviews.appendChild(noReviewsP);
                }
                reviewSection.appendChild(userReviews);

                 const reviewForm = document.createElement('form');
                 reviewForm.className = 'mt-3'; 

                 const ratingSelect = document.createElement('select');
                ratingSelect.className = 'form-select form-select-sm form-select-dark mb-2';                 ratingSelect.required = true; 
                const defaultOption = document.createElement('option');
                defaultOption.value = ""; defaultOption.textContent = "Rate (1-5 Stars)"; defaultOption.disabled = true; defaultOption.selected = true;
                ratingSelect.appendChild(defaultOption);
                for(let i = 5; i >= 1; i--) { 
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} Star${i > 1 ? 's' : ''}`;
                    ratingSelect.appendChild(option);
                }
                reviewForm.appendChild(ratingSelect);

                const feedbackInput = document.createElement('textarea');
                feedbackInput.className = 'form-control form-control-sm mb-2';
                feedbackInput.placeholder = 'Your feedback... (Optional)';
                feedbackInput.rows = 3;
                reviewForm.appendChild(feedbackInput);

                const submitButton = document.createElement('button');
                submitButton.type = 'submit';
                submitButton.textContent = 'Submit Review';
                submitButton.className = 'btn btn-success btn-sm w-100';
                reviewForm.appendChild(submitButton);

                reviewSection.appendChild(reviewForm);

                reviewForm.addEventListener('submit', function (event) {
                    event.preventDefault();

                    const selectedRating = ratingSelect.value;
                    const feedbackText = feedbackInput.value.trim(); 

                    if (!selectedRating) { 
                        alert('Please select a rating.');
                        return; 
                    }

                    
                    const newReview = {
                        user: "You", 
                        rating: parseInt(selectedRating),
                        feedback: feedbackText || "No feedback provided." 
                    };

                    const gameIndex = games.findIndex(g => g.id === game.id);
                    if (gameIndex !== -1) {
                        if (!games[gameIndex].reviews) {
                            games[gameIndex].reviews = [];
                        }
                        games[gameIndex].reviews.push(newReview);

                        const totalRating = games[gameIndex].reviews.reduce((sum, r) => sum + r.rating, 0);
                        games[gameIndex].rating = totalRating / games[gameIndex].reviews.length;

                    }

                    alert('Review submitted successfully!');
                   sortGames(); 
                    });

                gameBlock.appendChild(reviewSection);

                return gameBlock;
            }

            window.sortGames = function () {
                const sortOption = document.getElementById('ratingSort').value;
                let sortedGames = [...games]; 

                if (sortOption === 'highestToLowest') {
                    sortedGames.sort((a, b) => b.rating - a.rating);
                } else if (sortOption === 'lowestToHighest') {
                    sortedGames.sort((a, b) => a.rating - b.rating);
                }

                displayGames(sortedGames);
            }

            sortGames();
        });
    </script>

</body>
</html>